## File       : psid_data.R ####
## Description: ETL of Data 

# CSD I, II, and III Variable List ----------------------------------------
# ER30001: 1968 INTERVIEW NUMBER
# ER30002: PERSON NUMBER 68
# ER31996  SAMPLING ERROR STRATUM                  
# ER31997  SAMPLING ERROR CLUSTER     
# ER33401: 1997 INTERVIEW NUMBER
# ER33402: SEQUENCE NUMBER 97
# ER33403: RELATION TO HEAD 97
# ER33601: 2001 INTERVIEW NUMBER
# ER33602: SEQUENCE NUMBER 01
# ER33603: RELATION TO HEAD 01
# ER33901: 2007 INTERVIEW NUMBER
# ER33902: SEQUENCE NUMBER 07
# ER33903: RELATION TO HEAD 07
# Q1A33: AMT-MEDICAL CARE 97
# Q1E12A: HOW MUCH ALLOWANCE 97
# Q1F12A: HOW MUCH ALLOWANCE 97
# Q1G11C: SCH COSTS PREV YR-AMT 97
# Q1K10: NOT EAT FOR A DAY-NO $$ FOR FOOD 97
# Q1K3A: FOOD RUN OUT BEFORE GET $$ 97
# Q1K3B: NOT ENOUGH $$ FOR MORE FOOD 97
# Q1K7: EAT LESS-NO $$ FOR FOOD 97
# Q1K8: HUNGRY DIDN'T EAT-NO $$ FOR FOOD 97
# Q1K9: LOSE WEIGHT-NO $$ FOR FOOD 97
# Q21A19: AMT -DENTAL CARE 02
# Q21A20_2: AMT - OUTSIDE HH PAY DENTAL CARE 02
# Q21A23: AMT -MEDICAL CARE 02
# Q21A24_2: AMT - OUTSIDE HH PAY MEDICAL CARE 02
# Q21B11A1: CURR SCH COSTS - AMT 02
# Q21B12A1: SCH COSTS PREV YR - AMT 02
# Q21C10H: WKDAY:EXTRA-CURRIC ACTIVITIES 02
# Q21C15A: WKDAY: COST OF CARE - AMT 02
# Q21C15B: WKDAY: COST OF CARE - UNIT 02
# Q21C21A: WKDAY 2: COST OF CARE - AMT 02
# Q21C21B: WKDAY 2: COST OF CARE - UNIT 02
# Q21C22H: WKEND:EXT-CURRIC ACTIVITIES 02
# Q21C27A: WKEND: COST OF CARE - AMT 02
# Q21C27B: WKEND: COST OF CARE - UNIT 02
# Q21C28H: SUMMER:EXT-CURRIC ACTIVITIES 02
# Q21C33A: SUMMER: COST OF CARE - AMT 02
# Q21C33B: SUMMER: COST OF CARE - UNIT 02
# Q21C39A: SUMMER 2: COST OF CARE - AMT 02
# Q21C39B: SUMMER 2: COST OF CARE - UNIT 02
# Q21C7A_1: COSTS OF 1ST CARE PRE K - AMT 02
# Q21C7A_2: COSTS OF 2ND CARE PRE K - AMT 02
# Q21C7A_3: COSTS OF 3RD CARE PRE K - AMT 02
# Q21C7A_4: COSTS OF 4TH CARE PRE K - AMT 02
# Q21C7B_1: COSTS OF 1ST CARE PRE K - UNIT 02
# Q21C7B_2: COSTS OF 2ND CARE PRE K - UNIT 02
# Q21C7B_3: COSTS OF 3RD CARE PRE K - UNIT 02
# Q21C7B_4: COSTS OF 4TH CARE PRE K - UNIT 02
# Q21G10C: COST OF COMMUNITY GRPS 6-9 YRS 02
# Q21G21A1: ALLOWANCE - AMT 6-9 YRS 02
# Q21G21A2: ALLOWANCE - PER 6-9 YRS 02
# Q21G5D: COST OF TUTORING 6-9 YRS 02
# Q21H22B: ALLOWANCE - AMT 10+ YRS 02
# Q21H22C: ALLOWANCE - PER 10+ YRS 02
# Q21H23A1: AMT SPENT ON TOYS 02
# Q21H23B1: AMT SPENT OF VACATION 02
# Q21H23C1: AMT SPENT OF SCH SUPPLIES 02
# Q21H23D1: AMT SPENT ON CLOTHES 02
# Q21H23E1: AMT SPENT ON CAR INSUR 02
# Q21H23F1: AMT SPENT ON CAR PAYMTS 02
# Q21H23G1: AMT SPENT ON CAR MAINTENANCE 02
# Q21H23H1: AMT SPENT ON FOOD 02
# Q21H24J: ABSENT DAD SPEND ON ALLOWANCE 02
# Q21H24O: ABSENT DAD SPEND ON EXTRA-CURRICULAR 02 
# Q21H25J: ABSENT MOM SPEND ON ALLOWANCE 02
# Q21H25O: ABSENT DAD SPEND ON EXTRA-CURRICULAR 02 
# Q21H5C: COST OF TUTORING 10+ YRS 02
# Q21H8B: COST OF COMMUNITY GRPS 10+ YRS 02
# Q23L2: ALLOWANCE: AMT 02
# Q23L2A: ALLOWANCE: UNIT 02
# Q23L4A5: PAY CLOTHES 02
# Q2A51: $$ SPENT ON MED CARE & INSUR 97
# Q31B11A1: CURR SCHOOL COSTS - AMT 07
# Q31B11A2: CURR SCHOOL COSTS - PER 07
# Q31B12A1: PREV YR SCHOOL COSTS - AMT 07
# Q31B12A2: PREV YR SCHOOL COSTS - PER 07
# Q31C15A: WKDAY: COST OF CARE - AMT 07
# Q31C15B: WKDAY: COST OF CARE - UNIT 07
# Q31C21A: CWKDAY 2: COST OF CARE - AMT 07
# Q31C21B: WKDAY 2: COST OF CARE - UNIT 07
# Q31C27A: WKEND: COST OF CARE - AMT 07
# Q31C27B: WKEND: COST OF CARE - UNIT 07
# Q31C33A: SUMMER: COST OF CARE - AMT 07
# Q31C33B: SUMMER: COST OF CARE - UNIT 07
# Q31C39A: SUMMER 2: COST OF CARE - AMT 07
# Q31C39B: SUMMER 2: COST OF CARE - UNIT 07
# Q31H22B: ALLOWANCE - AMT 10+ YRS 07
# Q31H22C: ALLOWANCE - PER 10+ YRS 07
# Q31H23A1: AMT SPENT ON TOYS 07
# Q31H23B1: AMT SPENT ON VACATION 07
# Q31H23C1: AMT SPENT ON SCHOOL SUPPLIES 07
# Q31H23D1: AMT SPENT ON CLOTHES 07
# Q31H23E1: AMT SPENT ON CAR INSURANCE 07
# Q31H23F1: AMT SPENT ON CAR PAYMENTS 07
# Q31H23G1: AMT SPENT ON CAR MAINTENANCE 07
# Q31H5C: COST OF TUTORING 10+ YRS 07
# Q31H8B: COST OF COMM GRPS 10+ YRS 07
# Q32JA34: CHILDREN HEALTH OUT OF POCKET COSTS 07
# Q33L2: ALLOWANCE: AMT 07
# Q33L2A: ALLOWANCE: UNIT 07
# Q33L3F: PAST WK $ FOOD/DRINKS AT SCHOOL 07
# Q33L3G: PAST WK $ FAST FOOD/RESTAURANTS 07
# Q33L3H: PAST WK $ ALL OTH FOOD 07

# CDS I, II, and III Data -------------------------------------------------
# Read in custom PSID Excel Spreadsheet
psid.data     <- read.csv("J195269.csv") #CSV saved from Excel version for speed

# Read in corresponding variable labels
#CSV cleaned and saved from .txt version:
psid.labels           <- read.csv("J195269_labels.csv", header = F) 
colnames(psid.labels) <- c("varname", "desc")
psid.labels[, 1]      <- gsub(";", "", psid.labels[, 1])
psid.labels[, 2]      <- gsub(";", "", psid.labels[, 2])
psid.labels[, 2]      <- gsub("“", "", psid.labels[, 2])
psid.labels[, 2]      <- gsub("1968", "1968 ", psid.labels[, 2])
psid.labels[, 2]      <- gsub("1997", "1997 ", psid.labels[, 2])
psid.labels[, 2]      <- gsub("2002", "2002 ", psid.labels[, 2])
psid.labels[, 2]      <- gsub("2007", "2007 ", psid.labels[, 2])
psid.labels[, 2]      <- gsub("68", " 68", psid.labels[, 2])
psid.labels[, 2]      <- gsub("97", " 97", psid.labels[, 2])
psid.labels[, 2]      <- gsub("02", " 02", psid.labels[, 2])
psid.labels[, 2]      <- gsub("07", " 07", psid.labels[, 2])
psid.labels[, 2]      <- gsub("19 68", "1968", psid.labels[, 2])
psid.labels[, 2]      <- gsub("19 97", "1997", psid.labels[, 2])
psid.labels[, 2]      <- gsub("200 2", "2002", psid.labels[, 2])
psid.labels[, 2]      <- gsub("20 07", "2007", psid.labels[, 2])
psid.labels[, 1]      <- trim(psid.labels[, 1])
psid.labels[, 2]      <- trim(psid.labels[, 2])

# Read in CDS Map: Excel Spreadsheet
cdsMap.data   <- read.csv("M195269.csv", header = T) #CSV saved from .xlsx

# Read in CDS Map: Variable Labels
#CSV cleaned and saved from .txt version:
cdsMap.labels <- read.csv("M195269_labels.csv", header = F) 
colnames(cdsMap.labels) <- c("varname", "desc")
cdsMap.labels[, 1]      <- gsub(";", "", cdsMap.labels[, 1])
cdsMap.labels[, 2]      <- gsub(";", "", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("“", "", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("1968", "1968 ", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("1997", "1997 ", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("2002", "2002 ", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("2007", "2007 ", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("68", " 68", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("97", " 97", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("02", " 02", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("07", " 07", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("19 68", "1968", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("19 97", "1997", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("200 2", "2002", cdsMap.labels[, 2])
cdsMap.labels[, 2]      <- gsub("20 07", "2007", cdsMap.labels[, 2])
cdsMap.labels[, 1]      <- trim(cdsMap.labels[, 1])
cdsMap.labels[, 2]      <- trim(cdsMap.labels[, 2])

# Family-level Variable List (1997, 2003, 2007) ---------------------------
# ER10002	1997 INTERVIEW #
# ER10039	A23 HAVE MORTGAGE?
# ER10040	A23A TYPE MORTGAGE MOR 1
# ER10041	A23A TYPE MORTGAGE MOR 2
# ER10042	A23B WTR REFINANCED MTG1
# ER10043	A23B WTR REFINANCED MTG2
# ER10044	A24 REM PRINCIPAL MOR 1
# ER10045	A24 REM PRINCIPAL MOR 2
# ER10046	A25 MNTHLY PMTS MOR   1
# ER10047	A25 MNTHLY PMTS MOR   2
# ER10048	A25B CURR INT RATE MOR 1
# ER10049	A25B CURR INT RATE MOR 2
# ER10050	A25C             MOR   1
# ER10051	A25C             MOR   2
# ER10052	A26 YRS PAYING MOR    1
# ER10053	A26 YRS PAYING MOR    2
# ER10054	A27 YRS TO PAY MOR    1
# ER10055	A27 YRS TO PAY MOR    2
# ER10056	A28 2ND MORTGAGE
# ER10057	A28 3RD MORTGAGE
# ER10058	A29 MTG INCL PROP TAXES
# ER10060	A31 DOLLARS RENT
# ER21002	2003 FAMILY INTERVIEW (ID) NUMBER
# ER21048	A23 HAVE MORTGAGE?
# ER21049	A23A TYPE MORTGAGE MOR 1
# ER21050	A23B WTR ORIGINAL LOAN/REFINANCED #1
# ER21051	A24 REM PRINCIPAL MOR 1
# ER21052	ACCURACY OF REMAINING MORTGAGE PRIN #1
# ER21053	A25 MNTHLY PMTS MOR   1
# ER21054	ACCURACY OF MONTHLY PYMNTS ON MTGE #1
# ER21055	A25A CURR INTEREST RATE WHOLE PERCENT #1
# ER21056	A25A CURR INT RATE DECIMAL FRACTION #1
# ER21057	A26 YEAR OBTAINED LOAN #1
# ER21058	A27 YRS TO PAY MOR    1
# ER21059	A28 2ND MORTGAGE
# ER21060	A23A TYPE MORTGAGE MOR 2
# ER21061	A23B WTR ORIGINAL LOAN/REFINANCED #2
# ER21062	A24 REM PRINCIPAL MOR 2
# ER21063	ACCURACY OF REMAINING MORTGAGE PRIN #2
# ER21064	A25 MNTHLY PMTS MOR   2
# ER21065	ACCURACY OF MONTHLY PYMNTS ON MTGE #2
# ER21066	A25A CURR INTEREST RATE WHOLE PERCENT #2
# ER21067	A25A CURR INT RATE DECIMAL FRACTION #2
# ER21068	A26 YEAR OBTAINED LOAN #2
# ER21069	A27 YRS TO PAY MOR    2
# ER21070	A29 MTG INCL PROP TAXES
# ER21072	A31 DOLLARS RENT
# ER22621	W38 WTR OTHER DEBTS
# S606	IMP WTR OTH DEBT (W38) 03
# S620	IMP VALUE HOME EQUITY 03
# ER36002	2007 FAMILY INTERVIEW (ID) NUMBER
# ER36039	A23 HAVE MORTGAGE?
# ER36040	A23A TYPE MORTGAGE MOR 1
# ER36041	A23B WTR ORIGINAL LOAN/REFINANCED #1
# ER36042	A24 REM PRINCIPAL MOR 1
# ER36043	ACCURACY OF REMAINING MORTGAGE PRIN #1
# ER36044	A25 MNTHLY PMTS MOR 1
# ER36045	ACCURACY OF MONTHLY PYMNTS ON MTGE #1
# ER36046	A25A CURR INTEREST RATE WHOLE PERCENT #1
# ER36047	A25A CURR INT RATE DECIMAL FRACTION #1
# ER36048	A25A1 WTR CURR INT RATE FIXED/VARBLE #1
# ER36049	A26 YEAR OBTAINED LOAN #1
# ER36050	A27 YRS TO PAY MOR    1
# ER36051	A28 2ND MORTGAGE
# ER36052	A23A TYPE MORTGAGE MOR 2
# ER36053	A23B WTR ORIGINAL LOAN/REFINANCED #2
# ER36054	A24 REM PRINCIPAL MOR 2
# ER36055	ACCURACY OF REMAINING MORTGAGE PRIN #2
# ER36056	A25 MNTHLY PMTS MOR   2
# ER36057	ACCURACY OF MONTHLY PYMNTS ON MTGE #2
# ER36058	A25A CURR INTEREST RATE WHOLE PERCENT #2
# ER36059	A25A CURR INT RATE DECIMAL FRACTION #2
# ER36060	A25A1 WTR CURR INT RATE FIXED/VARBLE #2
# ER36061	A26 YEAR OBTAINED LOAN #2
# ER36062	A27 YRS TO PAY MOR    2
# ER36063	A29 MTG INCL PROP TAXES
# ER36065	A31 DOLLARS RENT
# ER37620	W38 WTR OTHER DEBTS
# S806	IMP WTR OTH DEBT (W38) 07
# S820	IMP VALUE HOME EQUITY 07

# Family-level Data -------------------------------------------------------
# Raw data
psid.data.fam <- read.csv("J195474.csv", header = T)

# Labels
psid.labels.fam <- read.csv("J195474_labels.csv", header = F)
